

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Perform a parameter sweep &mdash; Malaria Model  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within Malaria Model  documentation" href="_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/tipuesearch/tipuesearch.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Malaria Model  documentation" href="index.html"/>
        <link rel="up" title="Create a configuration file" href="howto-configuration.html"/>
        <link rel="next" title="Use configuration overlay files" href="howto-config-overlay.html"/>
        <link rel="prev" title="Generate a list of all available parameters (a schema)" href="howto-schema.html"/>

<link href="https://fonts.googleapis.com/css?family=Lato|Montserrat|Open+Sans" rel="stylesheet">



  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Malaria Model
          

          
            
            <img src="_static/IDM_white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.13
              </div>
            
          

          <div role="search">
  <form id='rtd-search-form' class='wy-form' action="search-local.html" method="get">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off"
           placeholder="Search docs" required>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Using the model</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whats-new.html">What’s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-overview.html">EMOD installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-overview.html">Introduction to the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-modeling.html">Introduction to disease modeling</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="howto-overview.html">How to use the software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="howto-inputs.html">Use input data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto-configuration.html">Create a configuration file</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="howto-campaign.html">Create a campaign file</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="howto-schema.html">Generate a list of all available parameters (a schema)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Perform a parameter sweep</a></li>
<li class="toctree-l3"><a class="reference internal" href="howto-campaign-overlay.html">Use campaign overlay files</a></li>
<li class="toctree-l3"><a class="reference internal" href="howto-targeted-interventions.html">Target interventions to nodes or groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="howto-simulations.html">Run simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="howto-outputs.html">Use output files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="malaria-overview.html">Malaria disease overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="malaria-model-overview.html">Malaria model overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="malaria-IDM.html">Malaria research at IDM</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter-overview.html">EMOD parameter reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-reference-overview.html">Input and output file structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting EMOD simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Advancing the model</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dev-install-overview.html">EMOD source code installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-architecture-overview.html">EMOD architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-debugging-overview.html">Debugging and testing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Malaria Model</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
  <li><a href="../index.html">IDM docs</a> &raquo;</li>
    <li><a href="index.html">Malaria</a> &raquo;</li>
      
          <li><a href="howto-overview.html">How to use the software</a> &raquo;</li>
      
          <li><a href="howto-configuration.html">Create a configuration file</a> &raquo;</li>
      
    <li>Perform a parameter sweep</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- From _templates/page.html -->

  <div class="section" id="perform-a-parameter-sweep">
<h1>Perform a parameter sweep<a class="headerlink" href="#perform-a-parameter-sweep" title="Permalink to this headline">¶</a></h1>
<p>Parameter sweeps iteratively update the values of parameters to exhaustively search through the
parameter space for a simulation. EMOD does not currently support automated parameter sweeps.
However, you can write your own code, such as a Python or MATLAB script, that iterates through the
values you want for a particular parameter. This topic describes how to perform a parameter sweep.</p>
<p>For example, you can run simulations using a Python script that uses the parameter values specified
in a JSON parameter sweep file to iteratively update the configuration or campaign parameter values.
The IDM test team performs parameter sweeps as part of regression testing. See the following
examples to see how this is implemented.</p>
<p>The following JSON example illustrates sweeping through configuration parameter values.</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;sweep&quot;</span> <span class="p">:</span>
    <span class="p">{</span>
        <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;43_Vector_Garki_MultiCore_VectorMigration&quot;</span><span class="p">,</span>
        <span class="nt">&quot;param_name&quot;</span> <span class="p">:</span> <span class="s2">&quot;Run_Number&quot;</span><span class="p">,</span>
        <span class="nt">&quot;param_values&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">144</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following Python example illustrates how to update the configuration file with the above values.
This is excerpted from the regression_test.py script in the <a class="reference external" href="https://github.com/InstituteforDiseaseModeling/EMOD/tree/master/Regression">Regression</a> directory.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">elif</span> <span class="s2">&quot;sweep&quot;</span> <span class="ow">in</span> <span class="n">reglistjson</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span> <span class="s2">&quot;Running sweep...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span>
    <span class="n">param_name</span> <span class="o">=</span> <span class="n">reglistjson</span><span class="p">[</span><span class="s2">&quot;sweep&quot;</span><span class="p">][</span><span class="s2">&quot;param_name&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">param_value</span> <span class="ow">in</span> <span class="n">reglistjson</span><span class="p">[</span><span class="s2">&quot;sweep&quot;</span><span class="p">][</span><span class="s2">&quot;param_values&quot;</span><span class="p">]:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">ru</span><span class="o">.</span><span class="n">cache_cwd</span><span class="p">)</span>
        <span class="n">sim_timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">regression_id</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">regression_id</span> <span class="o">=</span> <span class="n">sim_timestamp</span>

        <span class="n">configjson</span> <span class="o">=</span> <span class="n">ru</span><span class="o">.</span><span class="n">flattenConfig</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">reglistjson</span><span class="p">[</span><span class="s2">&quot;sweep&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">],</span> <span class="s2">&quot;param_overrides.json&quot;</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">configjson</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Error flattening config.  Skipping &quot;</span> <span class="o">+</span> <span class="n">simcfg</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>
            <span class="n">ru</span><span class="o">.</span><span class="n">final_warnings</span> <span class="o">+=</span> <span class="s2">&quot;Error flattening config.  Skipped &quot;</span> <span class="o">+</span> <span class="n">simcfg</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">continue</span>

        <span class="c1"># override sweep parameter</span>
        <span class="n">configjson</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_value</span>

        <span class="n">campjson_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">reglistjson</span><span class="p">[</span><span class="s2">&quot;sweep&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">],</span><span class="s2">&quot;campaign.json&quot;</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">campjson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span> <span class="n">campjson_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span> <span class="s2">&quot;u&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="s1">&#39;&quot;&#39;</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">campjson_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">configjson</span><span class="p">[</span><span class="s2">&quot;campaign_json&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">campjson</span><span class="p">)</span>

        <span class="n">report_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span> <span class="n">reglistjson</span><span class="p">[</span><span class="s2">&quot;sweep&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">],</span><span class="s2">&quot;custom_reports.json&quot;</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span> <span class="n">report_fn</span> <span class="p">)</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">reportjson_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span> <span class="n">report_fn</span> <span class="p">)</span>
            <span class="n">reportjson</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span> <span class="n">reportjson_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span> <span class="s2">&quot;u&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span> <span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span> <span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span> <span class="s1">&#39;&quot;&#39;</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">reportjson_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">configjson</span><span class="p">[</span><span class="s2">&quot;custom_reports_json&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">reportjson</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">configjson</span><span class="p">[</span><span class="s2">&quot;custom_reports_json&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="n">thread</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">commissionFromConfigJson</span><span class="p">(</span> <span class="n">sim_timestamp</span><span class="p">,</span> <span class="n">configjson</span><span class="p">,</span> <span class="n">reglistjson</span><span class="p">[</span><span class="s2">&quot;sweep&quot;</span><span class="p">][</span><span class="s2">&quot;path&quot;</span><span class="p">],</span> <span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;sweep&#39;</span> <span class="p">)</span>
        <span class="n">ru</span><span class="o">.</span><span class="n">reg_threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">thread</span> <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Unknown state&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>


<div id="tipue_search_content"></div>

           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="howto-config-overlay.html" class="btn btn-neutral float-right" title="Use configuration overlay files" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="howto-schema.html" class="btn btn-neutral" title="Generate a list of all available parameters (a schema)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Intellectual Ventures Management, LLC (IVM). All rights reserved.

    </p>
  </div>
<p>EMOD is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode">Creative Commons Attribution-Noncommercial-ShareAlike 4.0 License</a>.</p>
<p>Send documentation feedback to <a href="mailto:feedback@idmod.org" target="_top">feedback@idmod.org</a>.</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_content.js"></script>
      <script type="text/javascript" src="_static/tipuesearch/tipuesearch_set.js"></script>
      <script type="text/javascript" src="_static/runsearch.js"></script>
      <script type="text/javascript" src="_static/tablecollapse.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
<!-- Google analytics for IDM docs -->
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87656833-3', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>